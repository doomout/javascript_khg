<!--í…ìŠ¤íŠ¸ ë¡¤í”Œë ˆì‰ ê²Œì„
1. í™”ë©´ì€ 3ì¢…ë¥˜ : ì´ˆê¸°í™”ë©´, ì¼ë°˜ë©”ë‰´, ì „íˆ¬ë©”ë‰´
2. ì´ˆê¸°í™”ë©´: ì´ë¦„ì„ ì…ë ¥ ë°›ì•„ ì£¼ì¸ê³µ ìƒì„±
3. ì¼ë°˜í™”ë©´: ëª¨í—˜ ì„ íƒ-> ì „íˆ¬ ë©”ë‰´ í™”ë©´ ì „í™˜, íœ´ì‹ ì„ íƒ -> ì£¼ì¸ê³µ ì²´ë ¥ ìµœëŒ€ë¡œ íšŒë³µ
4. ì „íˆ¬í™”ë©´: ëœë¤í•˜ê²Œ ëª¬ìŠ¤í„° ë“±ì¥(ìŠ¬ë¼ì„, ìŠ¤ì¼ˆë ˆí†¤, ë§ˆì™• ê° 33% í™•ìœ¨)
5. ì „íˆ¬ ë©”ë‰´ í™”ë©´ì—ì„œëŠ” ëª¬ìŠ¤í„° ê³µê²©, ì²´ë ¥ íšŒë³µ, ë„ë§ ê°€ëŠ¥
6. ê³µê²© ì„ íƒì‹œ: ì£¼ì¸ê³µê³¼ ëª¬ìŠ¤í„°ì˜ ì²´ë ¥ì´ ì„œë¡œì˜ ê³µê²©ë ¥ ë§Œí¼ ê¹ì„
7. ì£¼ì¸ê³µì˜ ì²´ë ¥ì´ 0ì´ ë˜ë©´ ê²Œì„ ì˜¤ë²„
8. ëª¬ìŠ¤í„°ì˜ ì²´ë ¥ì´ 0ì´ ë˜ë©´ ê²½í—˜ì¹˜ ì–»ìŒ
9. ê²½í—˜ì¹˜ë¥¼ ì¼ì •ëŸ‰ ì–»ìœ¼ë©´: ë ˆë²¨ì—…í•˜ê³  ìµœëŒ€ ì²´ë ¥ê³¼ ê³µê²©ë ¥ ìƒìŠ¹í•˜ê³  ê¸°ì¡´ ì²´ë ¥ íšŒë³µ 
10. íšŒë³µ ì„ íƒì‹œ: ì²´ë ¥ì„ 20 íšŒë³µí•˜ëŠ” ëŒ€ì‹  ëª¬ìŠ¤í„°ì—ê²Œ ê³µê²© 1íšŒ ë‹¹í•¨
11. ë„ë§ ì„ íƒì‹œ: ì¼ë°˜ ë©”ë‰´ í™”ë©´ìœ¼ë¡œ ëŒì•„ì˜´
-->
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>í…ìŠ¤íŠ¸ RPG</title>
</head>
<body>
    <form id="start-screen">
        <input id="name-input" placeholder="ì£¼ì¸ê³µì˜ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”!"/>
        <button id="start">ì‹œì‘</button>
    </form>
    <div id="screen">
        <div id="hero-stat">
            <span id="hero-name"></span>
            <span id="hero-level"></span>
            <span id="hero-hp"></span>
            <span id="hero-xp"></span>
            <span id="hero-att"></span>
        </div>
        <form id="game-menu" style="display: none;">
            <div id="menu-1">1.ëª¨í—˜</div>
            <div id="menu-2">2.íœ´ì‹</div>
            <div id="menu-3">3.ì¢…ë£Œ</div>
            <input id="menu-input" />
            <button id="menu-button">ì…ë ¥</button>
        </form>
        <form id="battle-menu" style="display: none;">
            <div id="battle-1">1.ê³µê²©</div>
            <div id="battle-2">2.íšŒë³µ</div>
            <div id="battle-3">3.ë„ë§</div>
            <input id="battle-input" />
            <button id="battle-button">ì…ë ¥</button>
        </form>
        <div id="message"></div>
        <div id="monster-stat">
            <span id="monster-name"></span>
            <span id="monster-hp"></span>
            <span id="monster-att"></span>
        </div>
    </div>
<script>
    const $startScreen = document.querySelector('#start-screen'); // ì´ˆê¸° í™”ë©´
    const $gameMenu = document.querySelector('#game-menu'); // ì¼ë°˜ ë©”ë‰´ í™”ë©´
    const $battleMenu = document.querySelector('#battle-menu'); // ì „íˆ¬ ë©”ë‰´ í™”ë©´
    
    const $heroName = document.querySelector('#hero-name'); //ì£¼ì¸ê³µ ì´ë¦„
    const $heroLevel = document.querySelector('#hero-level'); //ì£¼ì¸ê³µ ë ˆë²¨
    const $heroHp = document.querySelector('#hero-hp'); //ì£¼ì¸ê³µ ì²´ë ¥
    const $heroXp = document.querySelector('#hero-xp'); //ì£¼ì¸ê³µ ê²½í—˜ì¹˜
    const $heroAtt = document.querySelector('#hero-att'); //ì£¼ì¸ê³µ ê³µê²©ë ¥

    const $monsterName = document.querySelector('#monster-name'); //ëª¬ìŠ¤í„° ì´ë¦„
    const $monsterHp = document.querySelector('#monster-hp'); //ëª¬ìŠ¤í„° ì²´ë ¥
    const $monsterAtt = document.querySelector('#monster-att'); //ëª¬ìŠ¤í„° ê³µê²©ë ¥
    const $message = document.querySelector('#message'); //ë©”ì„¸ì§€

    class Game {
        constructor(name) {
            this.monster = null;
            this.hero = null;
            this.monsterList = [
                { name: 'ìŠ¬ë¼ì„', hp: 25, att: 10, xp: 10 },
                { name: 'ìŠ¤ì¼ˆë ˆí†¤', hp: 50, att: 15, xp: 20 },
                { name: 'ë§ˆì™•', hp: 150, att: 35, xp: 50 },
            ];
            this.start(name);
        }
        start(name) {
            $gameMenu.addEventListener('submit', this.onGameMenuInput);
            $battleMenu.addEventListener('submit', this.onBattleMenuInput);
            this.changeScreen('game');
            this.hero = new Hero(name, this);// ì£¼ì¸ê³µ ê°ì²´ ìƒì„±í•  ë•Œ í˜„ì¬ ê²Œì„ì„ ì¶”ê°€
            this.updateHeroStat();
        }
        // ì£¼ì¸ê³µ ì •ë³´ í‘œì‹œ ë©”ì„œë“œ
        updateHeroStat() {
            const { hero } = this;
            if(hero === null) { // ì£¼ì¸ê³µ ì‚¬ë§ì‹œ
                $heroName.textContent = '';
                $heroLevel.textContent = '';
                $heroHp.textContent = ''; 
                $heroXp.textContent = '';
                $heroAtt.textContent = '';
                return;
            }
            // ì£¼ì¸ê³µ ì •ë³´ í‘œì‹œ
            $heroName.textContent = hero.name;
            $heroLevel.textContent = `${hero.lev}Lev`;
            $heroHp.textContent = `HP: ${hero.hp}/${hero.maxHp}`;
            $heroXp.textContent = `XP: ${hero.xp}/${15 * hero.lev}`;
            $heroAtt.textContent = `ATT: ${hero.att}`;
        }
        // í™”ë©´ ì „í™˜ ë©”ì„œë“œ
        changeScreen(screen) {
            if (screen === 'start') { // ì´ˆê¸°í™”ë©´
                $startScreen.style.display = 'block'; // ì´ˆê¸° í™”ë©´ ë³´ì´ê¸°
                $gameMenu.style.display = 'none'; 
                $battleMenu.style.display = 'none'; 
            } else if (screen === 'game') { // ì¼ë°˜ ë©”ë‰´
                $startScreen.style.display = 'none'; 
                $gameMenu.style.display = 'block'; // ì¼ë°˜ ë©”ë‰´ í™”ë©´ ë³´ì´ê¸°
                $battleMenu.style.display = 'none'; 
            } else if (screen === 'battle') { // ì „íˆ¬ ë©”ë‰´
                $startScreen.style.display = 'none'; 
                $gameMenu.style.display = 'none'; 
                $battleMenu.style.display = 'block'; // ì „íˆ¬ ë©”ë‰´ í™”ë©´ ë³´ì´ê¸°
            }
        }
        // ì¼ë°˜ ë©”ë‰´ ë©”ì„œë“œ
        onGameMenuInput = (event) => {
            event.preventDefault();
            const input = event.target['menu-input'].value;
            if (input === '1') { // ëª¨í—˜
                this.changeScreen('battle');
                this.createMonster(); // ëª¬ìŠ¤í„° ìƒì„±
            } else if (input === '2') { // íœ´ì‹

            } else if (input === '3') { // ì¢…ë£Œ
                this.quit();
                return;
            }
        }
        // ì „íˆ¬ ë©”ë‰´ ë©”ì„œë“œ
        onBattleMenuInput = (event) => {
            event.preventDefault();
            const input = event.target['battle-input'].value;
            if(input === '1') { // 1.ê³µê²©
                const { hero, monster } = this;
                hero.attack(monster);
                monster.attack(hero);
                // ì£¼ì¸ê³µ ì²´ë ¥ì´ 0ì´ë©´ ê²Œì„ ì˜¤ë²„
                if(hero.hp <= 0) {
                    this.showMessage(`${hero.lev}ë ˆë²¨ì—ì„œ ì „ì‚¬, ì£¼ì¸ê³µì„ ìƒˆë¡œ ìƒì„±í•˜ì„¸ìš”.`);
                    this.quit();
                } else if (monster.hp <= 0) { // ëª¬ìŠ¤í„° ì²´ë ¥ì´ 0ì´ë©´ ê²½í—˜ì¹˜ ì–»ìŒ
                    this.showMessage(`ëª¬ìŠ¤í„°ë¥¼ ì¡ì•„ ${monster.xp} ê²½í—˜ì¹˜ë¥¼ ì–»ì—ˆë‹¤.`);
                    hero.getXp(monster.xp);
                    this.monster = null;
                    this.updateHeroStat();
                    this.updateMonsterStat();
                    this.changeScreen('game');
                } else {
                    this.showMessage(`${hero.att}ì˜ í”¼í•´ë¥¼ ì£¼ê³ , ${monster.att}ì˜ í”¼í•´ë¥¼ ë°›ì•˜ë‹¤.`);
                    this.updateHeroStat();
                    this.updateMonsterStat();
                }
            } else if(input === '2') { // 2.íšŒë³µ
                const { hero, monster } = this;
                hero.heal(monster);

                // ì£¼ì¸ê³µ ì²´ë ¥ì´ 0ì´ë©´ ê²Œì„ ì˜¤ë²„
                if(hero.hp <= 0) {
                    this.showMessage(`${hero.lev}ë ˆë²¨ì—ì„œ ì „ì‚¬, ì£¼ì¸ê³µì„ ìƒˆë¡œ ìƒì„±í•˜ì„¸ìš”.`);
                    this.quit();
                    return;
                }

                this.showMessage(`20ì˜ ì²´ë ¥ì„ íšŒë³µí–ˆì§€ë§Œ, ${hero.att}ì˜ í”¼í•´ë¥¼ ë°›ì•˜ë‹¤.`);
                this.updateHeroStat();
                this.updateMonsterStat();
            
            } else if(input === '3') { // 3. ë„ë§
                this.changeScreen('game');
                this.updateHeroStat();
                this.updateMonsterStat();
            }
        }
        // ëª¬ìŠ¤í„° ìƒì„± ë©”ì„œë“œ
        createMonster(){
            const randomIndex = Math.floor(Math.random() * this.monsterList.length);
            const randomMonster = this.monsterList[randomIndex];
            this.monster = new Monster(
                randomMonster.name, 
                randomMonster.hp, 
                randomMonster.att, 
                randomMonster.xp
            );
            this.updateMonsterStat();
            this.showMessage(`ëª¬ìŠ¤í„°ì™€ ë§ˆì£¼ì³¤ë‹¤. ${this.monster.name}ì¸ ê²ƒ ê°™ë‹¤.`);
        }
        // ëª¬ìŠ¤í„° ì •ë³´ í‘œì‹œ ë©”ì„œë“œ
        updateMonsterStat() {
            const { monster } = this;
            if (monster === null) {
                $monsterName.textContent = '';
                $monsterHp.textContent = '';
                $monsterAtt.textContent = '';
                return;
            }
            // ìƒëŒ€í•  ëª¬ìŠ¤í„° ì •ë³´ í‘œì‹œ
            $monsterName.textContent = monster.name;
            $monsterHp.textContent = `HP: ${monster.hp}/${monster.maxHp}`;
            $monsterAtt.textContent = `ATT: ${monster.att}`;
        }
        showMessage(text) {
            $message.textContent = text;
        }
        // ê²Œì„ ì˜¤ë²„ ë©”ì„œë“œ
        quit() {
            this.hero = null;
            this.monster = null;
            this.updateHeroStat();
            this.updateMonsterStat();
            $gameMenu.removeEventListener('submit', this.onGameMenuInput);
            $battleMenu.removeEventListener('submit', this.onBattleMenuInput);

            // ğŸ’¡ ì£¼ì¸ê³µ ì´ë¦„ ì…ë ¥ì°½ ì´ˆê¸°í™”
            $startScreen.querySelector('#name-input').value = '';

            this.changeScreen('start');
            game = null;
        }
    }

    // ê³µí†µ í´ë˜ìŠ¤
    class Unit { 
        constructor(name, hp, att, xp) { // ìƒì„±ì
            this.name = name;
            this.maxHp = hp;
            this.hp = hp;
            this.xp = xp;
            this.att = att;
        }
        attack(target) { // ê³µê²© ë©”ì„œë“œ
            target.hp -= this.att;
        }
    }

    // ì£¼ì¸ê³µ í´ë˜ìŠ¤
    class Hero extends Unit { 
        constructor(name, game) { // ìƒì„±ì
            super(name, 100, 10, 0);
            this.lev = 1;
            this.game = game;
        }
        heal(monster) {
            // ëª¬ìŠ¤í„° ê³µê²© 1ë²ˆ ë°›ìŒ
            this.hp -= monster.att;
            // ì²´ë ¥ íšŒë³µ
            this.hp += 20;
            // ë§Œì•½ íì´ ìµœëŒ€ ì²´ë ¥ì„ ë„˜ì–´ì„œë©´
            if(this.hp > this.maxHp) { 
                this.hp = this.maxHp; // ìµœëŒ€ ì²´ë ¥ê¹Œì§€ë§Œ íšŒë³µ
            }
        }
        getXp(xp) { // ë ˆë²¨ì—… ë©”ì„œë“œ
            this.xp += xp;
            if(this.xp >= this.lev * 15) { // ê²½í—˜ì¹˜ë¥¼ ë‹¤ ì±„ìš°ë©´(ì£¼ì¸ê³µ ë ˆë²¨ * 15)
                this.xp -= this.lev * 15;
                this.lev += 1;
                this.maxHp += 5;
                this.att += 5;
                this.hp = this.maxHp;
                this.game.showMessage(`ë ˆë²¨ ì—…! ${this.lev}ë ˆë²¨ì´ ë˜ì—ˆìŠµë‹ˆë‹¤.`);
            }
        }
    }
    // ëª¬ìŠ¤í„° í´ë˜ìŠ¤
    class Monster extends Unit { 
        
    }
    let game = null;

    $startScreen.addEventListener('submit', (event) => {
        event.preventDefault();
        const name = event.target['name-input'].value;
        game = new Game(name); // ê²Œì„ ê°ì²´ ìƒì„±
    });
</script>
</body>
</html>